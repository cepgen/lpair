*-- Author :    O. Duenger   17/12/91
      SUBROUTINE GAMGAM(SQRTS,V1,V2,V3,V5,V6,V7,VMIN,VMAX,DJ,NOPT,X,NM)

      IMPLICIT DOUBLE PRECISION (A-H,O-Z)

      COMMON /VARIAB/ E,E1,E2,E3,E4,E5,P,P3,P4,P5,CT3,ST3,CT4,ST4,CT5,
     &                ST5,CP3,SP3,CP5,SP5
      COMMON /VARIAC/ AL3,AL4,BE4,BE5,DE3,DE5,PP3,PP4,PP5
      COMMON /VARIAD/ E6,E7,P6,P7,CT6,ST6,CT7,ST7,CP6,SP6,CP7,SP7,W
      COMMON /PICKZZ/ W1,W2,W3,W4,W5,W31,W52,W12,TAU,SL1
      COMMON /DOTPS/  Q1DQ,Q1DQ2,W6
      COMMON /DOTP/   P12,P13,P14,P15,P23,P24,P25,P34,P35,P45,P1K2,P2K1
      COMMON /CIVITA/ EPSI,G5,G6,A5,A6,BB
      COMMON /EXTRA/  S1,S2,T1,T2
      COMMON /EXT/    CTG,STG,CPG,SPG
      COMMON /ANGU/   CTCM6,STCM6
      COMMON /QVEC/   QVE(4)

      DIMENSION X(7)

      DATA PI/3.14159265358979D+00/,CONST/2.1868465D+10/

      W6=V6*V6
      W7=V7*V7
      WMIN=V6+V7
      IF(WMIN.LT.VMIN)WMIN=VMIN
      WMIN=WMIN*WMIN
      E=SQRTS
      S=E*E
      WMAX=E-V3-V5
      IF(WMAX.GT.VMAX)WMAX=VMAX
      WMAX=WMAX*WMAX
      XW=X(5)
      CALL MAPW2(W4,XW,WMIN,WMAX,DW)
      V4=DSQRT(W4)
      W=V4
      CALL ORIENT(S,V1,V2,V3,V4,V5,DJ,NOPT,X)
      IF(T1.GT.0.OR.T2.GT.0)DJ=0.
      IF(DJ.EQ.0) RETURN
      ECM6=(W4+W6-W7)/(2.*V4)
      PCM6=DSQRT(ECM6*ECM6-W6)
      DJ=DJ*DW*PCM6/(V4*CONST*S)
C     WRITE(6,*) ' E3MP3=W3/(E3+P3) :',W3,E3,P3
      E3MP3=W3/(E3+P3)
      E1MP1=W1/(E1+P)
      EG=(W4+T1-T2)/(2.*V4)
      PG=DSQRT(EG*EG-T1)
      PGX=-PP3*CP3*CT4-ST4*(DE3-E1MP1+E3MP3+P3*AL3)
      PGY=-PP3*SP3
      PGZ=V4*DE3/(E4+P4)-E4*DE3*AL4/V4-PP3*CP3
     &    *E4*ST4/V4+E4*CT4/V4*(P3*AL3+E3MP3-E1MP1)
      PGP=DSQRT(PGX*PGX+PGY*PGY)
      PGG=DSQRT(PGP*PGP+PGZ*PGZ)
      IF(PGG.GT.PGP*0.9.AND.PGG.GT.PG)PG=PGG
      STG=PGP/PG
      CPG=PGX/PGP
      SPG=PGY/PGP
      CTG=DSQRT(1.-STG*STG)
      IF(PGZ.LT.0)CTG=-CTG
      XX6=X(6)
      IF(NM.EQ.0)GO TO 1
      AMAP=.5*(W4-T1-T2)
      BMAP=.5*DSQRT(((W4-T1-T2)**2-4.*T1*T2)*(1.-4.*W6/W4))
      YMAP=(AMAP+BMAP)/(AMAP-BMAP)
      BETA=YMAP**(2.*XX6-1.)
      XX6=(AMAP/BMAP*(BETA-1.)/(BETA+1.)+1.)*0.5
      IF(XX6.GT.1.)XX6=1.
      IF(XX6.LT.0.)XX6=0.
      CTCM6=1.-2.*XX6
      DDD=(AMAP+BMAP*CTCM6)*(AMAP-BMAP*CTCM6)/AMAP/BMAP*DLOG(YMAP)
      DJ=DJ*DDD*0.5
1     CTCM6=1.-2.*XX6
      STCM6=2.*DSQRT(XX6*(1.-XX6))
      PHICM6=2.*PI*X(7)
      CPCM6=DCOS(PHICM6)
      SPCM6=DSIN(PHICM6)
      PCM6X=PCM6*STCM6*CPCM6
      PCM6Y=PCM6*STCM6*SPCM6
      PCM6Z=PCM6*CTCM6
      PC6Z=CTG*PCM6Z-STG*PCM6X
      H1=STG*PCM6Z+CTG*PCM6X
      PC6X=CPG*H1-SPG*PCM6Y
      QCX=2.*PC6X
      QCZ=2.*PC6Z
      P6Y=CPG*PCM6Y+SPG*H1
      E6=(E4*ECM6+P4*PC6Z)/V4
      H2=(E4*PC6Z+P4*ECM6)/V4
      P6X=CT4*PC6X+ST4*H2
      P6Z=CT4*H2-ST4*PC6X
      QVE(1)=P4*QCZ/V4
      QVE(3)=2.*P6Y
      HQ=E4*QCZ/V4
      QVE(2)=CT4*QCX+ST4*HQ
      QVE(4)=CT4*HQ-ST4*QCX
      P6=DSQRT(E6*E6-W6)
      E7=E4-E6
      P7=DSQRT(E7*E7-W7)
      P7X=PP4-P6X
      P7Y=-P6Y
      P7Z=P4*CT4-P6Z
      PP6=DSQRT(P6X*P6X+P6Y*P6Y)
      PP7=DSQRT(P7X*P7X+P7Y*P7Y)
      CT6=P6Z/P6
      ST6=PP6/P6
      CT7=P7Z/P7
      ST7=PP7/P7
      CP6=P6X/PP6
      SP6=P6Y/PP6
      CP7=P7X/PP7
      SP7=P7Y/PP7
      Q1DQ=EG*(2.*ECM6-V4)-2.*PG*PCM6*CTCM6
      Q1DQ2=0.5*(W4-T1-T2)
      BB=T1*T2+(W4*STCM6*STCM6+4.*W6*CTCM6*CTCM6)*PG*PG
      Q0=QVE(1)
      QX=QVE(2)
      QY=QVE(3)
      QZ=QVE(4)
      C1=(QX*SP3-QY*CP3)*PP3
      C2=(QZ*E1-Q0*P)*PP3
      C3=(W31*E1*E1+2.*W1*DE3*E1-W1*DE3*DE3+PP3*PP3*E1*E1)
     &   /(E3*P+P3*CT3*E1)
      B1=(QX*SP5-QY*CP5)*PP5
      B2=(QZ*E2+Q0*P)*PP5
      B3=(W52*E2*E2+2.*W2*DE5*E2-W2*DE5*DE5+PP5*PP5*E2*E2)
     &   /(E2*P5*CT5-E5*P)
      R12=C2*SP3+QY*C3
      R13=-C2*CP3-QX*C3
      R22=B2*SP5+QY*B3
      R23=-B2*CP5-QX*B3
      EPSI=P12*C1*B1+R12*R22+R13*R23
      G5=W1*C1*C1+R12*R12+R13*R13
      G6=W2*B1*B1+R22*R22+R23*R23
      A5=-(QX*CP3+QY*SP3)*PP3*P1K2-(E1*Q0-P*QZ)*(CP3*CP5+SP3*SP5)
     &    *PP3*PP5+(DE5*QZ+Q0*(P+P5*CT5))*C3
      A6=-(QX*CP5+QY*SP5)*PP5*P2K1-(E2*Q0+P*QZ)*(CP3*CP5+SP3*SP5)
     &    *PP3*PP5+(DE3*QZ-Q0*(P-P3*CT3))*B3

      RETURN
      END
